<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<html>
	<head>
<script src="jquery-1.6.js" type="text/javascript"></script>
<script src="jquery.urlshortener.js" type="text/javascript"></script>
<script src="eddystone.js" type="text/javascript"></script>
<style>
.info
{
	display:inline;
}
</style>

<title>Eddystone URL Demo</title>
</head>
<body>



	<h3 align="center">Eddystone URL Demoo</h3>
	<div style="text-align:center">  
	
    <button onclick = "choose()">Choose Device</button><br/><br/>
	
	  Enter the full URL to broadcast:<br>
	  <input id='longUrl' type="text" name="url"/> <br/><br/>
	  
	  <button id="shortIt" >Short it</button><br/><br/>
	  
	   <div class="info" id="shortUrlInfo">Shorted url will appear here is successfull</div> <br><br>
	  
	  <button id="submit" >Submit</button><br/><br/>
	 
	</div>

<script type="text/javascript">


		
   var characteristic;
   var shortedUrl , longUrl;
      
$("#submit").click(function () {
	if((characteristic!==null) && (typeof(characteristic)!=='undefined')){
	
		if(shortedUrl!==null&&(typeof(shortedUrl)!=='undefined'))
		onWrite(shortedUrl);
		
	}else{
		
	alert('Please choose a device first by clicking on Choose Device button.');
	}
	
	
	});
	
	function choose(){
	
	if (isWebBluetoothEnabled()) {
      
      onChooseClick();
    }
	
	}
	
	
	jQuery.urlShortener.settings.apiKey = 'AIzaSyAJ1cY6HGkca800Uf1WZzQx0g-atz56GV8';
	
	
	$("#shortIt").click(function () {

	if($("#longUrl").val().length>0)
	{
    $("#shortUrlInfo").html("<img src='images/loading.gif'/>");
    var longUrlLink = $("#longUrl").val();
    jQuery.urlShortener({
        longUrl: longUrlLink,
        success: function (shortUrl) {
            
			shortedUrl = shortUrl.split('://')[1];
			$("#shortUrlInfo").html(shortedUrl);
			
        },
        error: function(err)
        {
        	//$("#shortUrlInfo").html(JSON.stringify(err));
			$("#shortUrlInfo").html("Either entered value is invalid or some other error");
			shortedUrl = null;
        }
    });
	}else{
	
	alert('Please enter the long url first to get a shorter one.');
	
	}

});

function isWebBluetoothEnabled() {
    if (navigator.bluetooth) {
      return true;
    } else {
      alert('Web Bluetooth API is not available.\n' +
                              'Please make sure the Web Bluetooth flag is enabled.');
      return false;
    }
  }
  
</script>
		
	</body>
</html>
